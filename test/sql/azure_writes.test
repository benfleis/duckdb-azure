# name: test/sql/azure_writes.test
# description: test azure extension writes
# group: [sql]

require azure

require-env AZURE_STORAGE_CONNECTION_STRING

# Set azurite connection string from env var, auto secret goodness
statement ok
SET azure_storage_connection_string = '${AZURE_STORAGE_CONNECTION_STRING}';

query I
COPY (SELECT id: 42) TO 'az://writes/write-id-42.csv';
----
1

query I
SELECT count(*) FROM 'az://writes/write-id-42.csv';
----
1
